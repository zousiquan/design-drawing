<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36" version="29.3.1">
  <diagram id="6a731a19-8d31-9384-78a2-239565b7b9f0" name="Page-1">
    <mxGraphModel dx="1701" dy="924" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" background="none" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-58" edge="1" parent="1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-57" value="">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="460" y="100" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-70" edge="1" parent="1" source="D_rbxeIY8IHrmzFwVU9i-57" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-69" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-57" parent="1" style="whiteSpace=wrap;html=1;strokeWidth=2;" value="SSE&lt;div&gt;&lt;span style=&quot;font-family: -apple-system, BlinkMacSystemFont, Arial, &amp;quot;Microsoft YaHei&amp;quot;, &amp;quot;Microsoft JhengHei&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 13px; text-align: start; white-space: pre-wrap; background-color: rgb(218, 234, 252);&quot;&gt;kd.ai.chatbi.openapi.sse.ChatSSEService&lt;/span&gt;&lt;br&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="40" width="240" x="340" y="120" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-60" edge="1" parent="1" source="D_rbxeIY8IHrmzFwVU9i-59" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-57" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-59" parent="1" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;outlineConnect=0;" value="用户" vertex="1">
          <mxGeometry height="60" width="30" x="445" y="20" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-84" edge="1" parent="1" source="D_rbxeIY8IHrmzFwVU9i-69" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-83" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-69" parent="1" style="whiteSpace=wrap;html=1;strokeWidth=2;" value="Dify&lt;div&gt;&lt;span style=&quot;font-family: -apple-system, BlinkMacSystemFont, Arial, &amp;quot;Microsoft YaHei&amp;quot;, &amp;quot;Microsoft JhengHei&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 13px; text-align: start; white-space: pre-wrap; background-color: rgb(218, 234, 252);&quot;&gt;kd.ai.chatbi.service.chat.impl.DifyAiChatService&lt;/span&gt;&lt;br&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="50" width="120" x="290" y="200" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-74" edge="1" parent="1" source="D_rbxeIY8IHrmzFwVU9i-71" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-73" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-71" parent="1" style="whiteSpace=wrap;html=1;strokeWidth=2;" value="WorkFlowEngine&lt;div&gt;&lt;span style=&quot;font-family: -apple-system, BlinkMacSystemFont, Arial, &amp;quot;Microsoft YaHei&amp;quot;, &amp;quot;Microsoft JhengHei&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 13px; text-align: start; white-space: pre-wrap; background-color: rgb(218, 234, 252);&quot;&gt;kd.ai.chatbi.service.chat.impl.FlowAiChatService&lt;/span&gt;&lt;br&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="50" width="120" x="580" y="200" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-72" edge="1" parent="1" source="D_rbxeIY8IHrmzFwVU9i-57" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="D_rbxeIY8IHrmzFwVU9i-71" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <Array as="points">
              <mxPoint x="460" y="180" />
              <mxPoint x="640" y="180" />
            </Array>
            <mxPoint x="690" y="420" as="sourcePoint" />
            <mxPoint x="740" y="370" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-80" edge="1" parent="1" source="D_rbxeIY8IHrmzFwVU9i-73" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-79" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-73" parent="1" style="whiteSpace=wrap;html=1;strokeWidth=2;" value="FlowEngineRunner初始化" vertex="1">
          <mxGeometry height="60" width="150" x="565" y="310" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-77" parent="1" style="shape=document;whiteSpace=wrap;html=1;boundedLbl=1;align=left;" value="&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; FlowEngineRunner初始化&lt;div&gt;&lt;ul&gt;&lt;li&gt;1.根据workflowId加载工作流详情&lt;/li&gt;&lt;li&gt;2.加载模型配配置&lt;/li&gt;&lt;li style=&quot;&quot;&gt;3.加载子工作流详情&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="140" width="210" x="780" y="270" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-78" edge="1" parent="1" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" target="D_rbxeIY8IHrmzFwVU9i-77" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="715" y="350" as="sourcePoint" />
            <mxPoint x="770" y="330" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-82" edge="1" parent="1" source="D_rbxeIY8IHrmzFwVU9i-79" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-81" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-79" parent="1" style="whiteSpace=wrap;html=1;strokeWidth=2;" value="Flowengine.execute()" vertex="1">
          <mxGeometry height="60" width="120" x="580" y="410" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-81" parent="1" style="whiteSpace=wrap;html=1;strokeWidth=2;" value="FlowRunner.run()" vertex="1">
          <mxGeometry height="60" width="120" x="580" y="510" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-86" edge="1" parent="1" source="D_rbxeIY8IHrmzFwVU9i-83" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-85" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-83" parent="1" style="whiteSpace=wrap;html=1;strokeWidth=2;" value="参数构建" vertex="1">
          <mxGeometry height="55" width="120" x="290" y="325" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-88" edge="1" parent="1" source="D_rbxeIY8IHrmzFwVU9i-85" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-87" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="350" y="610" />
              <mxPoint x="500" y="610" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-85" parent="1" style="whiteSpace=wrap;html=1;strokeWidth=2;" value="dify调用" vertex="1">
          <mxGeometry height="60" width="120" x="290" y="457.5" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-93" edge="1" parent="1" source="D_rbxeIY8IHrmzFwVU9i-87" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-92" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-87" parent="1" style="whiteSpace=wrap;html=1;strokeWidth=2;" value="SSE结果输出" vertex="1">
          <mxGeometry height="60" width="120" x="440" y="670" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-89" edge="1" parent="1" source="D_rbxeIY8IHrmzFwVU9i-81" style="edgeStyle=segmentEdgeStyle;endArrow=classic;html=1;curved=0;rounded=0;endSize=8;startSize=8;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="D_rbxeIY8IHrmzFwVU9i-87" value="">
          <mxGeometry relative="1" width="100" as="geometry">
            <Array as="points">
              <mxPoint x="640" y="610" />
              <mxPoint x="500" y="610" />
            </Array>
            <mxPoint x="540" y="600" as="sourcePoint" />
            <mxPoint x="420" y="700" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-92" parent="1" style="rounded=1;whiteSpace=wrap;html=1;" value="结束" vertex="1">
          <mxGeometry height="60" width="120" x="440" y="767" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-95" parent="1" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WorkFlow主流程&lt;/h1&gt;&lt;p&gt;ai-chatbi-flowengine 工程是独立的工作流执行引擎，其核心原理是基于Graph的执行引擎；以下是chatbi内置的主工作流的大概执行流程&lt;/p&gt;" vertex="1">
          <mxGeometry height="120" width="250" x="1250" y="90" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-97" parent="1" style="swimlane;childLayout=stackLayout;resizeParent=1;resizeParentMax=0;startSize=20;horizontal=0;horizontalStack=1;" value="Pool" vertex="1">
          <mxGeometry height="1805" width="1153.755" x="1220" y="250" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-98" parent="D_rbxeIY8IHrmzFwVU9i-97" style="swimlane;startSize=20;" value="ai-chatbi-flowengine" vertex="1">
          <mxGeometry height="1805" width="372.5" x="20" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-104" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-98" source="D_rbxeIY8IHrmzFwVU9i-102" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-103" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-102" parent="D_rbxeIY8IHrmzFwVU9i-98" style="rounded=1;whiteSpace=wrap;html=1;" value="开始" vertex="1">
          <mxGeometry height="30" width="95" x="65" y="50" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-107" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-98" source="D_rbxeIY8IHrmzFwVU9i-103" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-106" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-103" parent="D_rbxeIY8IHrmzFwVU9i-98" style="whiteSpace=wrap;html=1;rounded=1;" value="FlowRunner.init()" vertex="1">
          <mxGeometry height="46" width="120" x="52.5" y="104" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-111" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-98" source="D_rbxeIY8IHrmzFwVU9i-106" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-110" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-106" parent="D_rbxeIY8IHrmzFwVU9i-98" style="whiteSpace=wrap;html=1;rounded=1;" value="FlowRunner.run()" vertex="1">
          <mxGeometry height="60" width="120" x="52.5" y="180" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-113" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-98" source="D_rbxeIY8IHrmzFwVU9i-110" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-112" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-110" parent="D_rbxeIY8IHrmzFwVU9i-98" style="whiteSpace=wrap;html=1;rounded=1;" value="StartNode" vertex="1">
          <mxGeometry height="60" width="120" x="52.5" y="270" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-115" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-98" source="D_rbxeIY8IHrmzFwVU9i-112" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-114" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-112" parent="D_rbxeIY8IHrmzFwVU9i-98" style="whiteSpace=wrap;html=1;rounded=1;" value="中间node&lt;br&gt;(问题改写、意图识别分等)" vertex="1">
          <mxGeometry height="60" width="120" x="52.5" y="370" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-114" parent="D_rbxeIY8IHrmzFwVU9i-98" style="whiteSpace=wrap;html=1;rounded=1;" value="关键词召回Node" vertex="1">
          <mxGeometry height="60" width="120" x="52.5" y="470" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-121" parent="D_rbxeIY8IHrmzFwVU9i-98" style="whiteSpace=wrap;html=1;rounded=1;" value="NER2DSL Node" vertex="1">
          <mxGeometry height="60" width="120" x="52.5" y="585" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-123" parent="D_rbxeIY8IHrmzFwVU9i-98" style="whiteSpace=wrap;html=1;rounded=1;" value="DSL召回与执行引擎Node" vertex="1">
          <mxGeometry height="60" width="120" x="52.5" y="710" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-124" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-98" source="D_rbxeIY8IHrmzFwVU9i-121" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-123" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-99" parent="D_rbxeIY8IHrmzFwVU9i-97" style="swimlane;startSize=20;" value="ai-chatbi-mservice / ai-chatbi-mservice-api" vertex="1">
          <mxGeometry height="1805" width="471.255" x="392.5" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-120" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-99" source="D_rbxeIY8IHrmzFwVU9i-116" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-119" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-116" parent="D_rbxeIY8IHrmzFwVU9i-99" style="whiteSpace=wrap;html=1;rounded=1;" value="RecallProxyService.recallKeyword()" vertex="1">
          <mxGeometry height="60" width="220" x="110" y="470" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-119" parent="D_rbxeIY8IHrmzFwVU9i-99" style="whiteSpace=wrap;html=1;rounded=1;" value="ai-chatbi-recallengine 召回引擎工程&lt;div&gt;RecallService.search&lt;/div&gt;" vertex="1">
          <mxGeometry height="70" width="260" x="90" y="580" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-131" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-99" source="D_rbxeIY8IHrmzFwVU9i-125" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-130" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-125" parent="D_rbxeIY8IHrmzFwVU9i-99" style="whiteSpace=wrap;html=1;rounded=1;" value="AgentController.queryDate" vertex="1">
          <mxGeometry height="60" width="170" x="135" y="710" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-133" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-99" source="D_rbxeIY8IHrmzFwVU9i-130" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-132" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-130" parent="D_rbxeIY8IHrmzFwVU9i-99" style="whiteSpace=wrap;html=1;rounded=1;" value="DslEngineService.chatDslToQueryDsl()" vertex="1">
          <mxGeometry height="60" width="240" x="100" y="810" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-135" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-99" source="D_rbxeIY8IHrmzFwVU9i-132" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-134" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-132" parent="D_rbxeIY8IHrmzFwVU9i-99" style="whiteSpace=wrap;html=1;rounded=1;" value="&lt;span style=&quot;background-color: transparent;&quot;&gt;DslHandler前处理&lt;/span&gt;&lt;br&gt;&lt;ul&gt;&lt;li style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;关键字处理&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;日期过滤条件补全&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;默认Agg时间粒度补全&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;" vertex="1">
          <mxGeometry height="90" width="240" x="100" y="910" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-134" parent="D_rbxeIY8IHrmzFwVU9i-99" style="whiteSpace=wrap;html=1;rounded=1;" value="DSL解析" vertex="1">
          <mxGeometry height="60" width="120" x="160" y="1050" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-146" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-99" source="D_rbxeIY8IHrmzFwVU9i-142" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-145" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-142" parent="D_rbxeIY8IHrmzFwVU9i-99" style="whiteSpace=wrap;html=1;rounded=1;" value="虚拟指标处理，剔除不合查询条件的指标&lt;div&gt;&lt;span style=&quot;font-family: -apple-system, BlinkMacSystemFont, Arial, &amp;quot;Microsoft YaHei&amp;quot;, &amp;quot;Microsoft JhengHei&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 13px; text-align: start; white-space: pre-wrap; background-color: rgb(218, 234, 252);&quot;&gt;postRewriteRuleService.vmetricProcess&lt;/span&gt;&lt;br&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="60" width="237.5" x="92.5" y="1310" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-148" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-99" source="D_rbxeIY8IHrmzFwVU9i-145" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-147" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-145" parent="D_rbxeIY8IHrmzFwVU9i-99" style="whiteSpace=wrap;html=1;rounded=1;" value="BusinessQueryModel一拆多&lt;div&gt;&lt;span style=&quot;font-family: -apple-system, BlinkMacSystemFont, Arial, &amp;quot;Microsoft YaHei&amp;quot;, &amp;quot;Microsoft JhengHei&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 13px; text-align: start; white-space: pre-wrap; background-color: rgb(218, 234, 252);&quot;&gt;SplitDslParseHelper.execute()&lt;/span&gt;&lt;br&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="60" width="240" x="91.25" y="1430" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-150" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-99" source="D_rbxeIY8IHrmzFwVU9i-147" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-149" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-147" parent="D_rbxeIY8IHrmzFwVU9i-99" style="whiteSpace=wrap;html=1;rounded=1;align=left;" value="&lt;div&gt;&lt;ul&gt;&lt;li&gt;查询函数拆分SelectFunctionSplitHandler&lt;/li&gt;&lt;li&gt;虚拟指标排名拆分VmRankingFunctionSplit&lt;/li&gt;&lt;li&gt;虚拟指标Top\bottom VmTopNAndBottomNFunctionSplit&lt;/li&gt;&lt;li&gt;OR条件拆分 OrSplitHandler&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="110" width="338.75" x="41.88" y="1530" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-149" parent="D_rbxeIY8IHrmzFwVU9i-99" style="whiteSpace=wrap;html=1;align=center;rounded=1;" value="根据AgentId获取rules" vertex="1">
          <mxGeometry height="60" width="120" x="151.255" y="1690" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-117" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-97" source="D_rbxeIY8IHrmzFwVU9i-114" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-116" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-118" connectable="0" parent="D_rbxeIY8IHrmzFwVU9i-117" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="&lt;span style=&quot;color: rgb(203, 75, 22); font-family: Menlo, monospace; font-size: 13px; text-align: start; white-space: normal; background-color: rgb(250, 250, 250);&quot;&gt;/kapi/v2/chatbi/cbi/recallKeyword&lt;/span&gt;" vertex="1">
          <mxGeometry relative="1" x="-0.1021" y="1" as="geometry">
            <mxPoint x="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-122" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-97" source="D_rbxeIY8IHrmzFwVU9i-119" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-121" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-126" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-97" source="D_rbxeIY8IHrmzFwVU9i-123" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-125" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-127" connectable="0" parent="D_rbxeIY8IHrmzFwVU9i-126" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="&lt;span style=&quot;color: rgb(203, 75, 22); font-family: Menlo, monospace; font-size: 13px; text-align: start; white-space: normal; background-color: rgb(250, 250, 250);&quot;&gt;/kapi/v2/chatbi/cbi/chatdsl/queryData&lt;/span&gt;" vertex="1">
          <mxGeometry relative="1" x="-0.0555" y="-5" as="geometry">
            <mxPoint x="1" y="-5" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-137" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-97" source="D_rbxeIY8IHrmzFwVU9i-134" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-136" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-100" parent="D_rbxeIY8IHrmzFwVU9i-97" style="swimlane;startSize=20;" value="ai-chatbi-dslengine" vertex="1">
          <mxGeometry height="1805" width="290" x="863.755" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-139" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-100" source="D_rbxeIY8IHrmzFwVU9i-136" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-138" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-136" parent="D_rbxeIY8IHrmzFwVU9i-100" style="whiteSpace=wrap;html=1;rounded=1;" value="DslParseHelper.parseToQueryModel()" vertex="1">
          <mxGeometry height="60" width="220" x="40" y="1050" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-138" parent="D_rbxeIY8IHrmzFwVU9i-100" style="whiteSpace=wrap;html=1;rounded=1;" value="PreProcessorChain前处理&lt;div&gt;&lt;ul&gt;&lt;li style=&quot;text-align: left;&quot;&gt;1.关键词处理&lt;/li&gt;&lt;li style=&quot;text-align: left;&quot;&gt;2.虚拟指标处理&lt;/li&gt;&lt;li style=&quot;text-align: left;&quot;&gt;3.日期函数转换&lt;/li&gt;&lt;li style=&quot;text-align: left;&quot;&gt;4.top\bottom函数处理&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="110" width="220" x="40" y="1160" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-140" parent="D_rbxeIY8IHrmzFwVU9i-100" style="whiteSpace=wrap;html=1;rounded=1;" value="语法解析DSLToSQLVisitor.visit()" vertex="1">
          <mxGeometry height="60" width="140" x="80" y="1310" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-141" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-100" source="D_rbxeIY8IHrmzFwVU9i-138" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-140" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-152" parent="D_rbxeIY8IHrmzFwVU9i-100" style="whiteSpace=wrap;html=1;align=center;rounded=1;" value="规则改写" vertex="1">
          <mxGeometry height="60" width="120" x="84.99999999999989" y="1690" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-143" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-97" source="D_rbxeIY8IHrmzFwVU9i-140" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-142" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-144" connectable="0" parent="D_rbxeIY8IHrmzFwVU9i-143" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="BusinessQueryModel" vertex="1">
          <mxGeometry relative="1" x="0.1922" y="1" as="geometry">
            <mxPoint x="20" y="-1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-153" edge="1" parent="D_rbxeIY8IHrmzFwVU9i-97" source="D_rbxeIY8IHrmzFwVU9i-149" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="D_rbxeIY8IHrmzFwVU9i-152" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-105" edge="1" parent="1" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="730" y="550" as="sourcePoint" />
            <mxPoint x="1210" y="550" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="D_rbxeIY8IHrmzFwVU9i-155" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;autosize=1;resizable=0;" value="BusinessQueryModel + Rules&amp;nbsp;" vertex="1">
          <mxGeometry height="30" width="190" x="1906" y="1947" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
